@page
@model DataCollectModel
@{
    ViewData["Title"] = "Data Collection";
}

<div class="row">
    <div class="col-8">
        <h1>Fee Input Parameters</h1>
        <form asp-page="Result" asp-area="Run" method="post">
            @for (int i = 0; i < Model.SelectedJurisdictions.Count(); i++)
            {
                <input type="hidden" asp-for="@Model.SelectedJurisdictions[i]" />
            }
            <div class="col-md-9">
                @for (int i = 0; i < Model.Inputs.Count; i++)
                {
                    <input type="hidden" asp-for="@Model.Inputs[i].Name" />
                    <input type="hidden" asp-for="@Model.Inputs[i].Type" />
                    switch (Model.Inputs[i].Var)
                    {
                        case DslInputDate:
                            var v0 = (DslInputDate)Model.Inputs[i].Var;
                            <div class="mb-3 col-md-6">
                                <label class="form-label" for="@v0.Name">@v0.Text</label>
                                <input class="form-control" type="date" asp-for="@Model.Inputs[i].DateValue" value="@v0.DefaultValue.ToString("yyyy-MM-dd")" min="@v0.MinValue.ToString("yyyy-MM-dd")" max="@v0.MaxValue.ToString("yyyy-MM-dd")">
                            </div>
                            break;
                        case DslInputList:
                            var v1 = (DslInputList)Model.Inputs[i].Var;
                            <label class="form-label" for="@v1.Name">@v1.Text</label>
                            <select class="form-select form-select-lg mb-3" asp-for="@Model.Inputs[i].StrValue">
                                @foreach (var item in v1.Items)
                                {
                                    if (v1.DefaultSymbol.Equals(item.Symbol))
                                    {
                                        <option selected value="@item.Symbol">@item.Value</option>
                                    }
                                    else
                                    {
                                        <option value="@item.Symbol">@item.Value</option>
                                    }
                                }
                            </select>
                            break;
                        case DslInputListMultiple:
                            var v2 = (DslInputListMultiple)Model.Inputs[i].Var;
                            <label class="form-label" for="@v2.Name">@v2.Text</label>
                            <select class="form-select form-select-lg mb-3" asp-for="@Model.Inputs[i].ListValue" multiple>
                                @foreach (var item in v2.Items)
                                {
                                    if (v2.DefaultSymbols.Contains(item.Symbol))
                                    {
                                        <option selected value="@item.Symbol">@item.Value</option>
                                    }
                                    else
                                    {
                                        <option value="@item.Symbol">@item.Value</option>
                                    }
                                }
                            </select>
                            break;
                        case DslInputNumber:
                            var v3 = (DslInputNumber)Model.Inputs[i].Var;
                            <div class="mb-3 col-md-6">
                                <label class="form-label" for="@v3.Name">@v3.Text</label>
                                <input class="form-control" type="number" asp-for="@Model.Inputs[i].DoubleValue" value="@v3.DefaultValue" min="@v3.MinValue" max="@v3.MaxValue">
                            </div>
                            break;
                        case DslInputBoolean:
                            var v4 = (DslInputBoolean)Model.Inputs[i].Var;
                            <div class="mb-3 form-check">
                                <label class="form-check-label" for="@v4.Name">@v4.Text</label>
                                @if (v4.DefaultValue)
                                {
                                    <input class="form-check-input" type="checkbox" asp-for="@Model.Inputs[i].BoolValue" value="true" checked>
                                    <input type="hidden" name="@v4.Name" value="false">
                                }
                                else
                                {
                                    <input class="form-check-input" type="checkbox" asp-for="@Model.Inputs[i].BoolValue" value="true">
                                    <input type="hidden" name="@v4.Name" value="false">
                                }
                            </div>
                            break;
                    }
                }
                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </div>
</div>

<div class="row">
    <div class="col-8 mt-5">
        @if (Model.Errors.Any())
        {
            <p>Fees for the following jurisdictions will <strong>not</strong> be calculated:</p>
            <ul>
                @foreach (var e in Model.Errors)
                {
                    <li>@e</li>
                }
            </ul>            
        }
    </div>
</div>
